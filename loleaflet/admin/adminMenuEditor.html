<link href="./css/menubar.css" rel="stylesheet">
<script>
    Admin.MenuEditor(host);
    L.DomUtil.setStyle(document.body, 'overflowY', 'hidden'); // 避免畫面上下捲動
</script>

<ul class="nav nav-pills mb-1" id="pills-tab" role="tablist">
    <li class="nav-item">
        <button id="writer-tab" class="nav-link active" data-bs-toggle="pill" data-bs-target="#writer" type="button" role="tab" aria-selected="true">
            <img src="../images/x-office-document.svg" style="vertical-align: sub; width: 18px; height: 18px;"/>&nbsp;
            <span _="Writer menu"></span>
        </button>
    </li>
    <li class="nav-item">
        <button id="calc-tab" class="nav-link" data-bs-toggle="pill" data-bs-target="#calc" type="button" role="tab" aria-selected="false">
            <img src="../images/x-office-spreadsheet.svg" style="vertical-align: sub; width: 18px; height: 18px;"/>&nbsp;
            <span _="Calc menu"></span>
        </button>
    </li>
    <li class="nav-item">
        <button id="impress-tab" class="nav-link" data-bs-toggle="pill" data-bs-target="#impress" type="button" role="tab" aria-selected="false">
            <img src="../images/x-office-presentation.svg" style="vertical-align: sub; width: 18px; height: 18px;"/>&nbsp;
            <span _="Impress menu"></span>
        </button>
    </li>
</ul>

<div id="main-menu" class="tab-content mb-3" style="border: 1px solid #dddddd; padding: 5px; border-radius: 6px;">
    <div id="writer" class="active tab-pane fade show">
        <ul id="writer-menu" class="sm sm-simple lo-menu"></ul>
    </div>
    <div id="calc" class="tab-pane fade">
        <ul id="calc-menu" class="sm sm-simple lo-menu"></ul>
    </div>
    <div id="impress" class="tab-pane fade">
        <ul id="impress-menu" class="sm sm-simple lo-menu"></ul>
    </div>
</div>

<div class="card mt-3 w-50">
    <div class="card-header">
        <span _="Instructions"></span>
    </div>
    <div class="card-body">
        <ul>
            <li _="The option is marked with a red line to indicate that it is disabled."></li>
            <li _="Click the option to enable or disable the function."></li>
            <li _="Disable the sub-menu, all options under it will also be disabled."></li>
            <li _="There are three menus available for editing: Writer menu, Calc menu, and Impress Menu."></li>
        </ul>
    </div>
</div>

<div class="btn-group btn-group-sm" role="group">
    <button id="updatemenu" type="button" class="btn btm-sm btn-outline-success"><i class="bi bi-save me-1"></i><span _="Update menu permissions."></span></button>
    <button id="showdisabledjson" type="button" class="btn btm-sm btn-outline-success"><i class="bi bi-file-text me-1"></i><span _="Show disabled JSON content."></span></button>
    <button id="showenabledjson" type="button" class="btn btm-sm btn-outline-success"><i class="bi bi-file-text me-1"></i><span _="Show enabled JSON content."></span></button>
    <button id="resetmenu" type="button" class="btn btm-sm btn-danger"><i class="bi bi-arrow-clockwise me-1"></i><span _="Reset menu"></span></button>
</div>

<!-- 顯示 JSON 內容視窗 -->
<div class="modal fade" id="showJsonContentDialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="jsonContentTitle"></h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="jsonContent" style="white-space: pre;font-size: 12px;">
        </div>
        <div class="modal-footer">
            <button id="downloadJson" type="button" class="btn btn-primary btn-sm">
                <i class="bi bi-download me-1"></i><span _="Download"></span>
            </button>
        </div>
        </div>
    </div>
</div>

<!-- toast -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 5">
    <div id="messageBox" class="toast hide border-0 text-white" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <strong class="me-auto" id="messageTitle"></strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="messageBody"></div>
    </div>
</div>